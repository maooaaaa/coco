<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Tools | é«˜æ©Ÿèƒ½ãƒ„ãƒ¼ãƒ«é›†</title>
    <style>
        :root {
            --primary: #3b82f6;
            --secondary: #1e40af;
            --bg: #f8fafc;
            --text: #1e293b;
            --sidebar-w: 260px;
        }
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0; display: flex; height: 100vh; background: var(--bg); color: var(--text);
        }
        
        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            width: var(--sidebar-w); background: #0f172a; color: #fff; display: flex; flex-direction: column;
            padding: 20px 0; flex-shrink: 0; box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        }
        .logo { font-size: 20px; font-weight: bold; text-align: center; margin-bottom: 30px; letter-spacing: 1px; color: #60a5fa; }
        .nav-item {
            padding: 15px 25px; cursor: pointer; transition: 0.2s; color: #94a3b8; font-size: 15px; display: flex; align-items: center; gap: 10px;
        }
        .nav-item:hover, .nav-item.active { background: #1e293b; color: #fff; border-left: 4px solid var(--primary); }
        
        /* ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ */
        .main { flex: 1; padding: 40px; overflow-y: auto; }
        .tool-box { display: none; animation: fadeUp 0.4s ease; max-width: 900px; margin: 0 auto; }
        .tool-box.active { display: block; }
        
        /* ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå…±é€š */
        h2 { border-bottom: 2px solid #e2e8f0; padding-bottom: 10px; margin-top: 0; color: var(--secondary); }
        .card { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); margin-bottom: 20px; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 14px; color: #64748b; }
        input, textarea, select {
            width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 16px; transition: 0.2s;
        }
        input:focus, textarea:focus, select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        button.btn {
            background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;
        }
        button.btn:hover { background: var(--secondary); }
        button.btn-outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); }
        button.btn-outline:hover { background: #eff6ff; }

        /* --- 1. æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ‹¡å¼µ --- */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px; }
        .stat-card { background: #f1f5f9; padding: 15px; border-radius: 8px; text-align: center; }
        .stat-val { font-size: 24px; font-weight: bold; color: var(--primary); display: block; }
        .stat-label { font-size: 12px; color: #64748b; }

        /* --- 2. é–¢æ•°é›»å“ --- */
        .calc-wrapper { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; }
        .display-area { text-align: right; background: #1e293b; color: #fff; padding: 20px; border-radius: 8px; margin-bottom: 15px; font-family: monospace; }
        #calc-history { font-size: 14px; color: #94a3b8; min-height: 20px; }
        #calc-main { font-size: 32px; font-weight: bold; }
        .keys-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        .key {
            padding: 15px; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; background: #f1f5f9; transition: 0.1s;
        }
        .key:active { transform: scale(0.95); }
        .key.fn { background: #e2e8f0; color: #334155; font-size: 14px; }
        .key.op { background: #dbeafe; color: #2563eb; }
        .key.eq { background: var(--primary); color: white; grid-column: span 2; }
        .key.ac { background: #ef4444; color: white; }
        .history-list { background: #f8fafc; padding: 15px; border-radius: 8px; height: 400px; overflow-y: auto; border: 1px solid #e2e8f0; }
        .hist-item { padding: 8px; border-bottom: 1px solid #e2e8f0; font-size: 14px; cursor: pointer; }
        .hist-item:hover { background: #e2e8f0; }

        /* --- 3. å˜ä½å¤‰æ›ï¼ˆãƒãƒ«ãƒï¼‰ --- */
        .unit-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .unit-card { background: #eff6ff; padding: 15px; border-radius: 8px; display: flex; flex-direction: column; }
        .unit-card strong { font-size: 12px; color: #64748b; margin-bottom: 5px; }
        .unit-card input { background: transparent; border: none; border-bottom: 1px solid #bfdbfe; border-radius: 0; font-weight: bold; color: #1e40af; }

        /* --- 4. æ¼¢å­—è©³ç´° --- */
        .kanji-detail { display: flex; gap: 30px; flex-wrap: wrap; }
        .kanji-big { 
            font-size: 120px; line-height: 1; border: 2px solid #e2e8f0; width: 150px; height: 150px; 
            display: flex; align-items: center; justify-content: center; border-radius: 12px;
        }
        .kanji-info table { width: 100%; border-collapse: collapse; }
        .kanji-info th { text-align: left; color: #64748b; padding: 5px 15px 5px 0; width: 80px; }
        .kanji-info td { padding: 5px 0; }
        .tags { display: flex; gap: 5px; margin-top: 10px; }
        .tag { font-size: 11px; padding: 3px 8px; border-radius: 10px; background: #e2e8f0; color: #475569; }

        @keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        @media (max-width: 768px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: auto; flex-direction: row; overflow-x: auto; padding: 10px; }
            .nav-item { white-space: nowrap; border-left: none; border-bottom: 3px solid transparent; padding: 10px 15px; }
            .nav-item.active { border-left: none; border-bottom-color: var(--primary); }
            .calc-wrapper { grid-template-columns: 1fr; }
            .history-list { height: 150px; margin-top: 10px; }
        }
    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="logo">TOOL HUB PRO</div>
        <div class="nav-item active" onclick="switchTab('text')">ğŸ“ é«˜æ©Ÿèƒ½ãƒ†ã‚­ã‚¹ãƒˆè§£æ</div>
        <div class="nav-item" onclick="switchTab('calc')">ğŸ§® é–¢æ•°é›»å“</div>
        <div class="nav-item" onclick="switchTab('unit')">âš–ï¸ ä¸‡èƒ½å˜ä½å¤‰æ›</div>
        <div class="nav-item" onclick="switchTab('kanji')">dictionary æ¼¢å­—è¾å…¸</div>
    </nav>

    <main class="main">
        
        <div id="text" class="tool-box active">
            <div class="card">
                <h2>ğŸ“ ãƒ†ã‚­ã‚¹ãƒˆè§£æ</h2>
                <textarea id="txtInput" rows="8" placeholder="ã“ã“ã«æ–‡ç« ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..." oninput="analyzeText()"></textarea>
                <div class="stats-grid">
                    <div class="stat-card"><span class="stat-label">å…¨æ–‡å­—æ•°</span><span id="c_total" class="stat-val">0</span></div>
                    <div class="stat-card"><span class="stat-label">ç©ºç™½é™¤å¤–</span><span id="c_nospace" class="stat-val">0</span></div>
                    <div class="stat-card"><span class="stat-label">è¡Œæ•°</span><span id="c_lines" class="stat-val">0</span></div>
                    <div class="stat-card"><span class="stat-label">æ®µè½æ•°</span><span id="c_para" class="stat-val">0</span></div>
                    <div class="stat-card"><span class="stat-label">åŸç¨¿ç”¨ç´™ (400å­—)</span><span id="c_paper" class="stat-val">0æš</span></div>
                    <div class="stat-card"><span class="stat-label">èª­äº†æ™‚é–“ (ç›®å®‰)</span><span id="c_time" class="stat-val">0ç§’</span></div>
                    <div class="stat-card"><span class="stat-label">ã‚µã‚¤ã‚º (UTF-8)</span><span id="c_byte" class="stat-val">0 B</span></div>
                </div>
            </div>
        </div>

        <div id="calc" class="tool-box">
            <div class="card calc-wrapper">
                <div>
                    <h2>ğŸ§® é–¢æ•°é›»å“</h2>
                    <div class="display-area">
                        <div id="calc-history"></div>
                        <div id="calc-main">0</div>
                    </div>
                    <div class="keys-grid">
                        <button class="key fn" onclick="inputFn('Math.sin(')">sin</button>
                        <button class="key fn" onclick="inputFn('Math.cos(')">cos</button>
                        <button class="key fn" onclick="inputFn('Math.tan(')">tan</button>
                        <button class="key fn" onclick="inputFn('Math.PI')">Ï€</button>
                        <button class="key ac" onclick="clearAll()">AC</button>
                        
                        <button class="key fn" onclick="inputFn('Math.sqrt(')">âˆš</button>
                        <button class="key fn" onclick="inputFn('(')">(</button>
                        <button class="key fn" onclick="inputFn(')')">)</button>
                        <button class="key fn" onclick="inputFn('**')">^</button>
                        <button class="key op" onclick="inputFn('/')">Ã·</button>
                        
                        <button class="key" onclick="inputNum('7')">7</button>
                        <button class="key" onclick="inputNum('8')">8</button>
                        <button class="key" onclick="inputNum('9')">9</button>
                        <button class="key" onclick="backspace()">BS</button>
                        <button class="key op" onclick="inputFn('*')">Ã—</button>

                        <button class="key" onclick="inputNum('4')">4</button>
                        <button class="key" onclick="inputNum('5')">5</button>
                        <button class="key" onclick="inputNum('6')">6</button>
                        <button class="key op" onclick="inputFn('-')">-</button>
                        <button class="key" onclick="inputNum('1')">1</button> <button class="key" onclick="inputNum('1')">1</button> 
                        <button class="key" onclick="inputNum('2')">2</button>
                        <button class="key" onclick="inputNum('3')">3</button>
                        <button class="key op" onclick="inputFn('+')">+</button>
                        <button class="key" style="visibility:hidden"> </button> <button class="key" onclick="inputNum('0')">0</button>
                        <button class="key" onclick="inputNum('.')">.</button>
                        <button class="key eq" onclick="calcResult()">=</button>
                    </div>
                </div>
                <div>
                    <h3>å±¥æ­´</h3>
                    <div class="history-list" id="histList">
                        <div style="padding:10px; color:#ccc; text-align:center">å±¥æ­´ãªã—</div>
                    </div>
                    <button class="btn-outline" style="width:100%; margin-top:10px;" onclick="clearHistory()">å±¥æ­´å‰Šé™¤</button>
                </div>
            </div>
        </div>

        <div id="unit" class="tool-box">
            <div class="card">
                <h2>âš–ï¸ ä¸‡èƒ½å˜ä½å¤‰æ›</h2>
                <div class="input-group">
                    <label>ã‚«ãƒ†ã‚´ãƒªãƒ¼é¸æŠ</label>
                    <select id="unit-category" onchange="renderUnitInputs()">
                        <option value="length">é•·ã• (Length)</option>
                        <option value="weight">é‡ã• (Weight)</option>
                        <option value="data">ãƒ‡ãƒ¼ã‚¿ (Data)</option>
                        <option value="temp">æ¸©åº¦ (Temperature)</option>
                        <option value="time">æ™‚é–“ (Time)</option>
                    </select>
                </div>
                <div id="unit-inputs" class="unit-grid">
                    </div>
            </div>
        </div>

        <div id="kanji" class="tool-box">
            <div class="card">
                <h2>dictionary æ¼¢å­—è¾å…¸</h2>
                <div style="display:flex; gap:10px;">
                    <input type="text" id="kInput" placeholder="æ¼¢å­—ä¸€æ–‡å­— (ä¾‹: å¤¢)" maxlength="1" style="font-size:20px;">
                    <button class="btn" onclick="fetchKanji()">æ¤œç´¢</button>
                </div>
                
                <div id="kResult" style="display:none; margin-top:30px;">
                    <div class="kanji-detail">
                        <div class="kanji-big" id="kChar">?</div>
                        <div class="kanji-info" style="flex:1;">
                            <div class="tags" id="kTags"></div>
                            <h3 id="kMeanings" style="margin:10px 0;">æ„å‘³...</h3>
                            <table>
                                <tr><th>éŸ³èª­ã¿</th><td id="kOn"></td></tr>
                                <tr><th>è¨“èª­ã¿</th><td id="kKun"></td></tr>
                                <tr><th>ç”»æ•°</th><td id="kStroke"></td></tr>
                                <tr><th>JLPT</th><td id="kJlpt"></td></tr>
                            </table>
                            <div style="margin-top:15px;">
                                <a id="kLink" href="#" target="_blank" class="btn-outline" style="text-decoration:none; padding:5px 10px; font-size:12px;">Weblioã§è©³ã—ãè¦‹ã‚‹</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- ç”»é¢åˆ‡ã‚Šæ›¿ãˆ ---
        function switchTab(id) {
            document.querySelectorAll('.tool-box').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        // --- 1. ãƒ†ã‚­ã‚¹ãƒˆè§£ææ©Ÿèƒ½ ---
        function analyzeText() {
            const txt = document.getElementById('txtInput').value;
            // åŸºæœ¬
            document.getElementById('c_total').innerText = txt.length;
            document.getElementById('c_nospace').innerText = txt.replace(/\s+/g, '').length;
            // è¡Œæ•°ï¼ˆç©ºè¡Œã‚‚å«ã‚€ï¼‰
            document.getElementById('c_lines').innerText = txt ? txt.split('\n').length : 0;
            // æ®µè½ï¼ˆç©ºè¡Œã§åŒºåˆ‡ã‚‹ï¼‰
            const paragraphs = txt.split(/\n\s*\n/).filter(p => p.trim().length > 0);
            document.getElementById('c_para').innerText = paragraphs.length;
            // åŸç¨¿ç”¨ç´™ (ç°¡æ˜“è¨ˆç®—: ç©ºç™½ã‚‚1æ–‡å­—ã¨ã¿ãªã™)
            document.getElementById('c_paper').innerText = Math.ceil(txt.length / 400) + "æš";
            // èª­äº†æ™‚é–“ (500æ–‡å­—/åˆ†)
            const sec = Math.ceil(txt.length / 500 * 60);
            document.getElementById('c_time').innerText = sec < 60 ? `${sec}ç§’` : `${Math.floor(sec/60)}åˆ†${sec%60}ç§’`;
            // ãƒã‚¤ãƒˆæ•° (UTF-8ç›®å®‰)
            const blob = new Blob([txt]);
            document.getElementById('c_byte').innerText = blob.size + " B";
        }

        // --- 2. é–¢æ•°é›»å“æ©Ÿèƒ½ ---
        let calcExp = '';
        const historyData = [];

        function inputNum(v) { calcExp += v; updateDisp(); }
        function inputFn(v) { calcExp += v; updateDisp(); }
        function backspace() { calcExp = calcExp.slice(0, -1); updateDisp(); }
        function clearAll() { calcExp = ''; document.getElementById('calc-history').innerText = ''; updateDisp(); }
        
        function updateDisp() {
            document.getElementById('calc-main').innerText = calcExp || '0';
        }

        function calcResult() {
            try {
                // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯è»½æ¸›ã®ãŸã‚ç°¡æ˜“ãƒã‚§ãƒƒã‚¯ç­‰ã¯çœç•¥ã—ã¦ã„ã¾ã™ãŒã€æœ¬æ¥ã¯Functionç­‰ã‚’ä½¿ã†ã¹ã
                // evalã®ä»£ã‚ã‚Šã«new Functionã‚’ä½¿ç”¨
                const res = new Function('return ' + calcExp)();
                
                // å±¥æ­´ã«è¿½åŠ 
                historyData.unshift({ exp: calcExp, res: res });
                renderHistory();
                
                document.getElementById('calc-history').innerText = calcExp + ' =';
                calcExp = String(res);
                updateDisp();
            } catch (e) {
                alert('è¨ˆç®—å¼ã‚¨ãƒ©ãƒ¼');
            }
        }

        function renderHistory() {
            const hList = document.getElementById('histList');
            hList.innerHTML = '';
            historyData.forEach(item => {
                const div = document.createElement('div');
                div.className = 'hist-item';
                div.innerHTML = `<div>${item.exp}</div><div style="font-weight:bold; text-align:right;">= ${item.res}</div>`;
                div.onclick = () => { calcExp = String(item.res); updateDisp(); };
                hList.appendChild(div);
            });
        }
        function clearHistory() { historyData.length = 0; renderHistory(); }

        // --- 3. ä¸‡èƒ½å˜ä½å¤‰æ›æ©Ÿèƒ½ ---
        const unitRates = {
            length: { m: 1, km: 1000, cm: 0.01, mm: 0.001, inch: 0.0254, ft: 0.3048, yard: 0.9144 },
            weight: { kg: 1, g: 0.001, mg: 0.000001, t: 1000, lb: 0.453592, oz: 0.0283495 },
            data:   { MB: 1, KB: 1/1024, GB: 1024, TB: 1024*1024, B: 1/1048576 },
            temp:   { C: 'base', F: 'func', K: 'func' }, // ç‰¹æ®Šå‡¦ç†
            time:   { min: 1, sec: 1/60, hour: 60, day: 1440, week: 10080 }
        };

        // åˆæœŸè¡¨ç¤º
        window.onload = function() { renderUnitInputs(); };

        function renderUnitInputs() {
            const cat = document.getElementById('unit-category').value;
            const container = document.getElementById('unit-inputs');
            container.innerHTML = '';
            
            const units = Object.keys(unitRates[cat]);
            
            units.forEach(u => {
                const div = document.createElement('div');
                div.className = 'unit-card';
                div.innerHTML = `
                    <strong>${u.toUpperCase()}</strong>
                    <input type="number" data-unit="${u}" oninput="calcUnit(this)">
                `;
                container.appendChild(div);
            });
        }

        function calcUnit(elm) {
            const cat = document.getElementById('unit-category').value;
            const val = parseFloat(elm.value);
            const currentUnit = elm.getAttribute('data-unit');
            const inputs = document.querySelectorAll('#unit-inputs input');

            if (isNaN(val)) {
                inputs.forEach(i => { if(i !== elm) i.value = ''; });
                return;
            }

            // æ¸©åº¦ã¯è¨ˆç®—å¼ãŒé•ã†ãŸã‚ç‰¹åˆ¥å¯¾å¿œ
            if (cat === 'temp') {
                let celsius;
                // ã¾ãšæ‘‚æ°ã«å¤‰æ›
                if (currentUnit === 'C') celsius = val;
                else if (currentUnit === 'F') celsius = (val - 32) * 5/9;
                else if (currentUnit === 'K') celsius = val - 273.15;

                inputs.forEach(i => {
                    if (i === elm) return;
                    const u = i.getAttribute('data-unit');
                    if (u === 'C') i.value = Math.round(celsius * 100) / 100;
                    if (u === 'F') i.value = Math.round((celsius * 9/5 + 32) * 100) / 100;
                    if (u === 'K') i.value = Math.round((celsius + 273.15) * 100) / 100;
                });
                return;
            }

            // ãã‚Œä»¥å¤–ã¯ä¿‚æ•°è¨ˆç®—
            const baseVal = val * unitRates[cat][currentUnit]; // åŸºæº–å˜ä½(å€¤1ã®ã‚‚ã®)ã«å¤‰æ›

            inputs.forEach(i => {
                if (i === elm) return;
                const u = i.getAttribute('data-unit');
                const rate = unitRates[cat][u];
                // æµ®å‹•å°æ•°ç‚¹èª¤å·®ã‚’ä¸¸ã‚ã‚‹
                let res = baseVal / rate;
                // æ¡æ•°èª¿æ•´ï¼ˆæœ€å¤§6æ¡ï¼‰
                i.value = parseFloat(res.toPrecision(7)) / 1; 
            });
        }

        // --- 4. æ¼¢å­—æ¤œç´¢æ©Ÿèƒ½ (kanjiapi.dev) ---
        async function fetchKanji() {
            const char = document.getElementById('kInput').value;
            if (!char) return;
            
            const resArea = document.getElementById('kResult');
            resArea.style.display = 'block';
            document.getElementById('kChar').innerText = '...';

            try {
                const res = await fetch(`https://kanjiapi.dev/v1/kanji/${char}`);
                if (!res.ok) throw new Error();
                const data = await res.json();

                document.getElementById('kChar').innerText = data.kanji;
                document.getElementById('kMeanings').innerText = data.meanings.join(', ');
                document.getElementById('kOn').innerText = data.on_readings.join(', ') || '-';
                document.getElementById('kKun').innerText = data.kun_readings.join(', ') || '-';
                document.getElementById('kStroke').innerText = data.stroke_count + 'ç”»';
                document.getElementById('kJlpt').innerText = data.jlpt ? `N${data.jlpt}` : '-';
                
                // ã‚¿ã‚°ç”Ÿæˆ
                const tags = document.getElementById('kTags');
                tags.innerHTML = `<span class="tag">Grade: ${data.grade || '-'}</span> <span class="tag">Unicode: ${data.unicode}</span>`;

                // å¤–éƒ¨è¾æ›¸ãƒªãƒ³ã‚¯
                document.getElementById('kLink').href = `https://www.weblio.jp/content/${char}`;

            } catch (e) {
                alert('è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
                resArea.style.display = 'none';
            }
        }
    </script>
</body>
</html>
