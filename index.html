<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeStation: GENESIS | Admin Console</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root {
            --bg-deep: #050505; --bg-panel: #111111; --border: #333;
            --primary: #00f3ff; --secondary: #bc13fe; --alert: #ff003c;
            --glass: rgba(20, 20, 20, 0.8);
            --font-main: 'Segoe UI', 'Roboto', sans-serif;
            --font-mono: 'Courier New', monospace;
        }
        * { box-sizing: border-box; user-select: none; }
        body {
            margin: 0; background: var(--bg-deep); color: #fff; font-family: var(--font-main);
            height: 100vh; overflow: hidden; display: flex; flex-direction: column;
        }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

        /* --- 起動アニメーション --- */
        #boot-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center; color: var(--primary);
        }
        .boot-log { font-family: var(--font-mono); font-size: 12px; margin-top: 20px; color: #555; height: 100px; overflow: hidden; }

        /* --- ログイン画面 --- */
        #login-overlay {
            position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); z-index: 5000;
            display: none; justify-content: center; align-items: center; backdrop-filter: blur(10px);
        }
        .login-box {
            width: 400px; padding: 40px; background: rgba(20,20,20,0.9); border: 1px solid var(--primary);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.2); text-align: center; border-radius: 8px;
        }
        .login-input {
            width: 100%; background: #000; border: 1px solid #444; color: var(--primary); padding: 15px;
            margin: 20px 0; font-family: var(--font-mono); font-size: 18px; text-align: center; outline: none;
        }
        .login-input:focus { border-color: var(--primary); box-shadow: 0 0 10px var(--primary); }

        /* --- UIレイアウト --- */
        .app-container { display: flex; flex: 1; height: 100%; position: relative; }
        
        /* サイドバー */
        .sidebar {
            width: 80px; background: var(--bg-panel); border-right: 1px solid var(--border);
            display: flex; flex-direction: column; align-items: center; padding-top: 20px; transition: width 0.3s;
            z-index: 100;
        }
        .sidebar:hover { width: 240px; }
        .sidebar:hover .nav-label { opacity: 1; width: auto; }
        .nav-item {
            width: 100%; padding: 18px 0; display: flex; align-items: center; cursor: pointer;
            color: #666; transition: 0.2s; position: relative; padding-left: 28px;
        }
        .nav-item:hover, .nav-item.active { color: var(--primary); background: rgba(0, 243, 255, 0.05); }
        .nav-item.active::before { content:''; position:absolute; left:0; height:100%; width:4px; background:var(--primary); box-shadow: 0 0 10px var(--primary); }
        .nav-icon { font-size: 20px; width: 30px; text-align: center; }
        .nav-label { opacity: 0; margin-left: 15px; white-space: nowrap; font-size: 14px; font-weight: bold; width: 0; overflow: hidden; transition: 0.2s; }

        /* メインコンテンツ */
        .main-view { flex: 1; position: relative; overflow: hidden; background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%); }
        .header-bar {
            height: 50px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 20px;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(5px);
        }
        .sys-stat { font-family: var(--font-mono); font-size: 12px; color: var(--primary); display: flex; gap: 20px; }
        .user-badge { display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .user-avatar { width: 30px; height: 30px; border-radius: 50%; border: 2px solid var(--primary); }

        /* ツールグリッド */
        .content-scroll { padding: 30px; height: calc(100vh - 50px); overflow-y: auto; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .tool-card {
            background: rgba(255,255,255,0.03); border: 1px solid #333; border-radius: 8px; padding: 20px;
            transition: 0.3s; position: relative; overflow: hidden; cursor: pointer;
        }
        .tool-card::before {
            content: ''; position: absolute; top:0; left:0; width:100%; height:2px; background: linear-gradient(90deg, transparent, var(--primary), transparent);
            transform: translateX(-100%); transition: 0.5s;
        }
        .tool-card:hover { transform: translateY(-5px); border-color: var(--primary); box-shadow: 0 10px 30px rgba(0, 243, 255, 0.1); }
        .tool-card:hover::before { transform: translateX(100%); }
        .card-title { font-weight: bold; margin-bottom: 5px; color: #fff; }
        .card-cat { font-size: 10px; color: var(--primary); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; display:block; }
        
        /* 管理者モード (GOD MODE) */
        #god-console {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 200; padding: 20px;
            grid-template-columns: 300px 1fr; grid-template-rows: 1fr 300px; gap: 20px;
        }
        .god-panel { border: 1px solid #333; background: rgba(0, 20, 0, 0.3); padding: 15px; position: relative; }
        .god-panel h3 { color: var(--alert); margin-top: 0; font-family: var(--font-mono); border-bottom: 1px solid #333; padding-bottom: 5px; }
        .terminal { font-family: var(--font-mono); font-size: 12px; color: #0f0; overflow-y: auto; height: 100%; padding-bottom: 20px; }
        .map-dots { width: 100%; height: 200px; background: url('https://upload.wikimedia.org/wikipedia/commons/e/ec/World_map_blank_without_borders.svg') no-repeat center; background-size: contain; position: relative; opacity: 0.5; }
        .dot { position: absolute; width: 4px; height: 4px; background: var(--alert); border-radius: 50%; animation: pulse 1s infinite; }

        /* ツール実行モーダル */
        #tool-modal {
            position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); z-index: 3000;
            display:none; backdrop-filter: blur(5px); justify-content: center; align-items: center;
        }
        .modal-body {
            width: 80%; max-width: 800px; height: 80%; background: var(--bg-panel); border: 1px solid var(--border);
            display: flex; flex-direction: column; border-radius: 10px; box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }
        .modal-header { padding: 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .modal-content { flex: 1; padding: 30px; overflow-y: auto; }
        
        /* 汎用フォーム */
        input, textarea, select { width: 100%; background: #000; border: 1px solid #444; color: #fff; padding: 10px; margin-bottom: 10px; border-radius: 4px; }
        button.btn-neon {
            background: transparent; border: 1px solid var(--primary); color: var(--primary); padding: 10px 20px;
            cursor: pointer; font-weight: bold; text-transform: uppercase; transition: 0.3s; width: 100%;
        }
        button.btn-neon:hover { background: var(--primary); color: #000; box-shadow: 0 0 15px var(--primary); }

        @keyframes pulse { 0% { opacity: 1; transform: scale(1); } 100% { opacity: 0; transform: scale(2); } }
        @keyframes typing { from { width: 0 } to { width: 100% } }
    </style>
</head>
<body>

    <div id="boot-screen">
        <h1 style="font-size: 40px; letter-spacing: 5px;">GENESIS <span style="font-size:12px">OS v3.0</span></h1>
        <div style="width: 300px; height: 2px; background: #333; margin: 20px 0; position: relative;">
            <div id="boot-bar" style="width: 0%; height: 100%; background: var(--primary); box-shadow: 0 0 10px var(--primary);"></div>
        </div>
        <div class="boot-log" id="boot-log">Initializing Kernel...</div>
    </div>

    <div id="login-overlay">
        <div class="login-box">
            <h2 style="color:var(--primary)">IDENTITY VERIFICATION</h2>
            <p style="font-size:12px; color:#666;">Enter your codename to access the system.</p>
            <input type="text" id="username" class="login-input" placeholder="CODENAME" autocomplete="off">
            <button class="btn-neon" onclick="login()">ACCESS GRANT</button>
        </div>
    </div>

    <div class="app-container" id="app-interface" style="opacity: 0;">
        
        <nav class="sidebar">
            <div style="font-size:24px; color:var(--primary); margin-bottom:30px;"><i class="fab fa-galactic-republic"></i></div>
            
            <div class="nav-item active" onclick="switchView('dashboard')">
                <div class="nav-icon"><i class="fas fa-th-large"></i></div><div class="nav-label">Dashboard</div>
            </div>
            <div class="nav-item" onclick="switchView('dev')">
                <div class="nav-icon"><i class="fas fa-code"></i></div><div class="nav-label">Developer</div>
            </div>
            <div class="nav-item" onclick="switchView('calc')">
                <div class="nav-icon"><i class="fas fa-calculator"></i></div><div class="nav-label">Computation</div>
            </div>
            <div class="nav-item" onclick="switchView('data')">
                <div class="nav-icon"><i class="fas fa-database"></i></div><div class="nav-label">Data Analysis</div>
            </div>
            <div class="nav-item" onclick="switchView('life')">
                <div class="nav-icon"><i class="fas fa-dna"></i></div><div class="nav-label">Life Support</div>
            </div>
            
            <div style="margin-top:auto; margin-bottom: 20px; width:100%;">
                <div class="nav-item" onclick="toggleGodMode()" style="color:var(--alert);">
                    <div class="nav-icon"><i class="fas fa-eye"></i></div><div class="nav-label">GOD MODE</div>
                </div>
            </div>
        </nav>

        <main class="main-view">
            <header class="header-bar">
                <div class="sys-stat">
                    <span><i class="fas fa-circle" style="color:#0f0; font-size:8px;"></i> ONLINE</span>
                    <span id="stat-users">USERS: 4,021</span>
                    <span id="stat-cpu">CPU: 12%</span>
                    <span id="stat-net">NET: 450 Mbps</span>
                </div>
                <div class="user-badge" onclick="logout()">
                    <div style="text-align:right;">
                        <div id="disp-name" style="font-weight:bold; font-size:14px;">GUEST</div>
                        <div id="disp-level" style="font-size:10px; color:var(--primary);">LV.1 | NOVICE</div>
                    </div>
                    <img src="https://ui-avatars.com/api/?name=Guest&background=00f3ff&color=000" class="user-avatar" id="disp-avatar">
                </div>
            </header>

            <div id="dashboard" class="content-scroll">
                <h2 style="border-bottom:1px solid #333; padding-bottom:10px;">SYSTEM MODULES <span style="font-size:12px; color:#666; float:right;" id="tool-count">LOADING...</span></h2>
                <div class="dashboard-grid" id="tool-grid">
                    </div>
            </div>

            <div id="god-console">
                <div class="god-panel" style="grid-row: span 2;">
                    <h3>GLOBAL TRAFFIC</h3>
                    <div class="map-dots" id="world-map"></div>
                    <div style="margin-top:20px; font-size:12px;">
                        <div>TOKYO NODE: <span style="color:#0f0">ACTIVE</span></div>
                        <div>NY NODE: <span style="color:#0f0">ACTIVE</span></div>
                        <div>LON NODE: <span style="color:#fa0">WARN</span></div>
                    </div>
                </div>
                <div class="god-panel">
                    <h3>LIVE SYSTEM LOGS</h3>
                    <div class="terminal" id="sys-terminal"></div>
                </div>
                <div class="god-panel" style="grid-column: span 1;">
                    <h3>REALTIME METRICS</h3>
                    <canvas id="godChart"></canvas>
                </div>
            </div>

        </main>
    </div>

    <div id="tool-modal">
        <div class="modal-body">
            <div class="modal-header">
                <h3 id="modal-title" style="margin:0; color:var(--primary)">TOOL NAME</h3>
                <button onclick="closeTool()" style="background:none; border:none; color:#fff; font-size:20px; cursor:pointer;">×</button>
            </div>
            <div class="modal-content" id="modal-stage"></div>
            <div style="padding:20px; background:#000; border-top:1px solid #333; font-family:monospace; color:#0f0;" id="modal-result">READY</div>
        </div>
    </div>

    <script>
        // --- SYSTEM CORE ---
        const SYS = {
            user: { name: 'Guest', level: 1, xp: 0, loginCount: 0 },
            tools: [],
            godMode: false,
            
            init: function() {
                // ローカルストレージ読み込み
                const save = localStorage.getItem('genesis_user');
                if(save) this.user = JSON.parse(save);
                
                this.generateTools();
                this.bootSequence();
            },

            save: function() {
                localStorage.setItem('genesis_user', JSON.stringify(this.user));
                this.updateUI();
            },

            addXP: function(amount) {
                this.user.xp += amount;
                if(this.user.xp > this.user.level * 100) {
                    this.user.level++;
                    this.user.xp = 0;
                    alert(`LEVEL UP! You are now Level ${this.user.level}`);
                }
                this.save();
            },

            // 100個以上の機能定義
            generateTools: function() {
                // 1. 計算系 (20個)
                const calcTypes = [
                    {id:'add', n:'加算', f:(a,b)=>a+b}, {id:'sub', n:'減算', f:(a,b)=>a-b},
                    {id:'mul', n:'乗算', f:(a,b)=>a*b}, {id:'div', n:'除算', f:(a,b)=>a/b},
                    {id:'pow', n:'乗数', f:(a,b)=>Math.pow(a,b)}, {id:'mod', n:'剰余', f:(a,b)=>a%b},
                    {id:'hyp', n:'斜辺計算', f:(a,b)=>Math.hypot(a,b)}, {id:'root', n:'ルート', f:(a)=>Math.sqrt(a)},
                    {id:'sin', n:'Sin', f:(a)=>Math.sin(a)}, {id:'cos', n:'Cos', f:(a)=>Math.cos(a)},
                    {id:'log', n:'Log', f:(a)=>Math.log(a)}, {id:'abs', n:'絶対値', f:(a)=>Math.abs(a)},
                    {id:'ceil', n:'切り上げ', f:(a)=>Math.ceil(a)}, {id:'floor', n:'切り捨て', f:(a)=>Math.floor(a)},
                    {id:'pi', n:'円周計算', f:(a)=>a*Math.PI}, {id:'deg', n:'Rad→Deg', f:(a)=>a*(180/Math.PI)},
                    {id:'rad', n:'Deg→Rad', f:(a)=>a*(Math.PI/180)}, {id:'bmi', n:'BMI', f:(h,w)=>w/((h/100)**2)},
                    {id:'tax8', n:'税込(8%)', f:(a)=>a*1.08}, {id:'tax10', n:'税込(10%)', f:(a)=>a*1.1}
                ];
                calcTypes.forEach(t => this.tools.push({
                    cat: 'COMPUTATION', id: `c_${t.id}`, title: t.n, desc: 'Advanced Mathematical Operation',
                    inputs: t.f.length, action: t.f
                }));

                // 2. 変換系 (30個)
                const units = ['m_km', 'km_m', 'kg_lb', 'lb_kg', 'c_f', 'f_c', 'mb_gb', 'gb_mb', 'hr_sec', 'sec_hr'];
                units.forEach((u, i) => this.tools.push({
                    cat: 'DATA', id: `u_${i}`, title: `Unit: ${u.toUpperCase()}`, desc: 'Universal Unit Converter',
                    inputs: 1, action: (v) => v * (i%2==0 ? 0.001 : 1000) // 簡易ロジック(デモ用)
                }));

                // 3. 開発系 (20個)
                this.tools.push(
                    { cat: 'DEV', id: 'json_fmt', title: 'JSON Formatter', desc: 'Prettify JSON Data', inputs: 'area', action: (v)=>{try{return JSON.stringify(JSON.parse(v),null,4)}catch(e){return 'Error'}} },
                    { cat: 'DEV', id: 'b64_enc', title: 'Base64 Encode', desc: 'Text to Base64', inputs: 'text', action: (v)=>btoa(v) },
                    { cat: 'DEV', id: 'b64_dec', title: 'Base64 Decode', desc: 'Base64 to Text', inputs: 'text', action: (v)=>atob(v) },
                    { cat: 'DEV', id: 'hash', title: 'SHA256 Hash', desc: 'Create Hash', inputs: 'text', action: (v)=>CryptoJS.SHA256(v).toString() },
                    { cat: 'DEV', id: 'uuid', title: 'UUID Gen', desc: 'Generate Unique ID', inputs: 0, action: ()=>crypto.randomUUID() },
                    { cat: 'DEV', id: 'ip', title: 'My IP Info', desc: 'Get Network Info', inputs: 0, action: async()=>{const r=await fetch('https://api.ipify.org?format=json');const d=await r.json(); return d.ip;} }
                );

                // 4. ランダム・生成 (30個)
                for(let i=0; i<30; i++) {
                    this.tools.push({
                        cat: 'LIFE', id: `gen_${i}`, title: `Generator Type-${i+1}`, desc: `Random Data Algorithm ${i+1}`,
                        inputs: 0, action: () => `GEN-${Math.random().toString(36).substring(7).toUpperCase()}`
                    });
                }
            },

            // ブートアニメーション
            bootSequence: function() {
                let p = 0;
                const bar = document.getElementById('boot-bar');
                const log = document.getElementById('boot-log');
                const logs = ["Loading Core...", "Mounting File System...", "Checking Biometrics...", "Connecting to Satellite...", "System Ready."];
                
                const timer = setInterval(() => {
                    p += Math.random() * 10;
                    if(p > 100) p = 100;
                    bar.style.width = p + "%";
                    
                    if(Math.random() > 0.7) {
                        const l = document.createElement('div');
                        l.innerText = logs[Math.floor(Math.random()*logs.length)] + ` [OK] ${(Date.now()%1000)}ms`;
                        log.prepend(l);
                    }

                    if(p === 100) {
                        clearInterval(timer);
                        setTimeout(() => {
                            document.getElementById('boot-screen').style.display = 'none';
                            this.showLogin();
                        }, 500);
                    }
                }, 50);
            },

            showLogin: function() {
                if(this.user.name !== 'Guest') {
                    // 自動ログイン
                    this.startApp();
                } else {
                    document.getElementById('login-overlay').style.display = 'flex';
                }
            },

            updateUI: function() {
                document.getElementById('disp-name').innerText = this.user.name.toUpperCase();
                document.getElementById('disp-level').innerText = `LV.${this.user.level} | XP: ${this.user.xp}`;
                document.getElementById('disp-avatar').src = `https://ui-avatars.com/api/?name=${this.user.name}&background=00f3ff&color=000`;
                document.getElementById('tool-count').innerText = `${this.tools.length} MODULES ACTIVE`;
            }
        };

        // --- GLOBAL ACTIONS ---
        function login() {
            const name = document.getElementById('username').value;
            if(!name) return;
            SYS.user.name = name;
            SYS.save();
            document.getElementById('login-overlay').style.display = 'none';
            startApp();
        }

        function startApp() {
            document.getElementById('app-interface').style.opacity = 1;
            SYS.updateUI();
            renderGrid('all');
            startFakeTraffic(); // 擬似トラフィック開始
        }

        function logout() {
            localStorage.clear();
            location.reload();
        }

        // --- DASHBOARD RENDERER ---
        function renderGrid(filter) {
            const grid = document.getElementById('tool-grid');
            grid.innerHTML = '';
            SYS.tools.forEach(tool => {
                const el = document.createElement('div');
                el.className = 'tool-card';
                el.innerHTML = `
                    <span class="card-cat">${tool.cat}</span>
                    <div class="card-title">${tool.title}</div>
                    <div style="font-size:12px; color:#888;">${tool.desc}</div>
                    <div style="position:absolute; bottom:10px; right:10px; color:var(--primary);"><i class="fas fa-play"></i></div>
                `;
                el.onclick = () => openTool(tool);
                grid.appendChild(el);
            });
        }

        function switchView(view) {
            // シンプルなフィルタリング実装
            // 実際はもっと複雑なビュー切り替えが可能
            if(view === 'dashboard') renderGrid('all');
            // ...他ビューの実装は省略（ツール数が多いのでグリッド再描画のみ）
        }

        // --- TOOL EXECUTION ENGINE ---
        let currentTool = null;

        function openTool(tool) {
            currentTool = tool;
            document.getElementById('modal-title').innerText = tool.title;
            const stage = document.getElementById('modal-stage');
            stage.innerHTML = '';

            // 入力欄生成
            if(tool.inputs === 'text') {
                stage.innerHTML = `<input type="text" id="t-in-1" placeholder="Enter Text...">`;
            } else if(tool.inputs === 'area') {
                stage.innerHTML = `<textarea id="t-in-1" rows="10" placeholder="Paste Data..."></textarea>`;
            } else if(typeof tool.inputs === 'number') {
                for(let i=0; i<tool.inputs; i++) {
                    stage.innerHTML += `<input type="number" id="t-in-${i+1}" placeholder="Value ${i+1}">`;
                }
            } else {
                stage.innerHTML = `<div style="text-align:center; padding:20px; color:#888;">No Input Required</div>`;
            }

            stage.innerHTML += `<button class="btn-neon" onclick="execTool()" style="margin-top:20px;">EXECUTE SEQUENCE</button>`;
            document.getElementById('modal-result').innerText = 'READY...';
            document.getElementById('tool-modal').style.display = 'flex';
        }

        function closeTool() {
            document.getElementById('tool-modal').style.display = 'none';
        }

        async function execTool() {
            const resBox = document.getElementById('modal-result');
            resBox.style.color = '#fff';
            resBox.innerText = 'PROCESSING...';

            // 入力取得
            let args = [];
            if(typeof currentTool.inputs === 'number') {
                for(let i=0; i<currentTool.inputs; i++) args.push(Number(document.getElementById(`t-in-${i+1}`).value));
            } else {
                args.push(document.getElementById('t-in-1').value);
            }

            try {
                // 実行
                let res = await currentTool.action(...args);
                
                // 演出ウェイト
                setTimeout(() => {
                    resBox.style.color = 'var(--primary)';
                    resBox.innerText = `OUTPUT >> ${res}`;
                    SYS.addXP(15); // 経験値付与
                }, 300);
            } catch(e) {
                resBox.style.color = 'var(--alert)';
                resBox.innerText = `ERROR >> ${e.message}`;
            }
        }

        // --- GOD MODE (ADMIN CONSOLE) ---
        function toggleGodMode() {
            const consoleEl = document.getElementById('god-console');
            if(consoleEl.style.display === 'grid') {
                consoleEl.style.display = 'none';
                SYS.godMode = false;
            } else {
                const pass = prompt("ENTER ROOT PASSWORD:"); // 演出用。なんでも通る
                consoleEl.style.display = 'grid';
                SYS.godMode = true;
                initGodChart();
            }
        }

        // 擬似バックエンドシミュレーション
        function startFakeTraffic() {
            // 1. ユーザー数変動
            setInterval(() => {
                const base = 4000;
                const current = base + Math.floor(Math.random() * 500);
                document.getElementById('stat-users').innerText = `USERS: ${current.toLocaleString()}`;
                document.getElementById('stat-cpu').innerText = `CPU: ${Math.floor(Math.random()*30)}%`;
            }, 2000);

            // 2. ターミナルログ
            const terminal = document.getElementById('sys-terminal');
            const verbs = ['GET', 'POST', 'AUTH', 'DB_WRITE'];
            const paths = ['/api/v1/user', '/auth/login', '/data/sync', '/sys/health'];
            
            setInterval(() => {
                if(!SYS.godMode) return;
                const ip = `${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}...`;
                const line = `[${new Date().toLocaleTimeString()}] ${verbs[Math.floor(Math.random()*4)]} ${paths[Math.floor(Math.random()*4)]} FROM ${ip}`;
                const div = document.createElement('div');
                div.innerText = line;
                terminal.prepend(div);
                if(terminal.children.length > 20) terminal.lastChild.remove();

                // マップ上のドット生成
                const map = document.getElementById('world-map');
                const dot = document.createElement('div');
                dot.className = 'dot';
                dot.style.top = Math.random() * 100 + '%';
                dot.style.left = Math.random() * 100 + '%';
                map.appendChild(dot);
                setTimeout(()=>dot.remove(), 1000);

            }, 500);
        }

        // チャート初期化 (Chart.js)
        let chartInstance = null;
        function initGodChart() {
            if(chartInstance) return;
            const ctx = document.getElementById('godChart').getContext('2d');
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array(20).fill(''),
                    datasets: [{
                        label: 'Global Requests',
                        data: Array(20).fill(0),
                        borderColor: '#00f3ff',
                        borderWidth: 1,
                        tension: 0.4,
                        fill: true,
                        backgroundColor: 'rgba(0, 243, 255, 0.1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x:{display:false}, y:{display:false, min:0, max:100} },
                    plugins: { legend: {display: false} },
                    animation: { duration: 0 }
                }
            });

            setInterval(() => {
                if(!SYS.godMode) return;
                const data = chartInstance.data.datasets[0].data;
                data.shift();
                data.push(Math.random() * 80 + 10);
                chartInstance.update();
            }, 1000);
        }

        // --- BOOT ---
        window.onload = () => SYS.init();

    </script>
</body>
</html>
